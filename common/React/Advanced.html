<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>进阶功能 | 微光的个人空间</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="此心光明，夫复何求">
    <meta name="keywords" content="前端，博客，微光">
    <meta name="author" content="微光">
    
    <link rel="preload" href="/docs/assets/css/0.styles.ec62b53c.css" as="style"><link rel="preload" href="/docs/assets/js/app.2c569677.js" as="script"><link rel="preload" href="/docs/assets/js/2.b553e760.js" as="script"><link rel="preload" href="/docs/assets/js/9.1f4f5613.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.27f358f4.js"><link rel="prefetch" href="/docs/assets/js/11.5e0534be.js"><link rel="prefetch" href="/docs/assets/js/12.a8e27388.js"><link rel="prefetch" href="/docs/assets/js/13.659b955f.js"><link rel="prefetch" href="/docs/assets/js/14.b50a1ddb.js"><link rel="prefetch" href="/docs/assets/js/15.60a6e67e.js"><link rel="prefetch" href="/docs/assets/js/16.39eb65dc.js"><link rel="prefetch" href="/docs/assets/js/17.9152cade.js"><link rel="prefetch" href="/docs/assets/js/18.2f507d00.js"><link rel="prefetch" href="/docs/assets/js/19.522a0124.js"><link rel="prefetch" href="/docs/assets/js/20.9f8f8ed1.js"><link rel="prefetch" href="/docs/assets/js/21.0f0c4298.js"><link rel="prefetch" href="/docs/assets/js/22.52f04b6c.js"><link rel="prefetch" href="/docs/assets/js/23.8effa93c.js"><link rel="prefetch" href="/docs/assets/js/24.aa7e3823.js"><link rel="prefetch" href="/docs/assets/js/25.99fd944c.js"><link rel="prefetch" href="/docs/assets/js/26.2249d5eb.js"><link rel="prefetch" href="/docs/assets/js/27.faa0dfcc.js"><link rel="prefetch" href="/docs/assets/js/28.7967f478.js"><link rel="prefetch" href="/docs/assets/js/29.cb4d6ec0.js"><link rel="prefetch" href="/docs/assets/js/3.733d138c.js"><link rel="prefetch" href="/docs/assets/js/30.225a2b1f.js"><link rel="prefetch" href="/docs/assets/js/31.3e922dc0.js"><link rel="prefetch" href="/docs/assets/js/32.c3edfaba.js"><link rel="prefetch" href="/docs/assets/js/33.577309f7.js"><link rel="prefetch" href="/docs/assets/js/34.a33bb6f7.js"><link rel="prefetch" href="/docs/assets/js/35.4fb51e90.js"><link rel="prefetch" href="/docs/assets/js/36.d8148370.js"><link rel="prefetch" href="/docs/assets/js/37.6f38f7b2.js"><link rel="prefetch" href="/docs/assets/js/38.2ffc33cc.js"><link rel="prefetch" href="/docs/assets/js/39.4c392a9b.js"><link rel="prefetch" href="/docs/assets/js/4.26e91e99.js"><link rel="prefetch" href="/docs/assets/js/40.b9cd47c9.js"><link rel="prefetch" href="/docs/assets/js/41.f80814d7.js"><link rel="prefetch" href="/docs/assets/js/42.56088e8e.js"><link rel="prefetch" href="/docs/assets/js/43.eca173b9.js"><link rel="prefetch" href="/docs/assets/js/5.9c5ce922.js"><link rel="prefetch" href="/docs/assets/js/6.0fdbb52f.js"><link rel="prefetch" href="/docs/assets/js/7.351b5044.js"><link rel="prefetch" href="/docs/assets/js/8.c3bb1637.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.ec62b53c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">微光的个人空间</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/common/" class="nav-link router-link-active">
  常见技术栈
</a></div><div class="nav-item"><a href="/docs/deepUse/" class="nav-link">
  深入理解
</a></div><div class="nav-item"><a href="/docs/tools/" class="nav-link">
  工具和扩展
</a></div><div class="nav-item"><a href="/docs/project/" class="nav-link">
  项目
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/common/" class="nav-link router-link-active">
  常见技术栈
</a></div><div class="nav-item"><a href="/docs/deepUse/" class="nav-link">
  深入理解
</a></div><div class="nav-item"><a href="/docs/tools/" class="nav-link">
  工具和扩展
</a></div><div class="nav-item"><a href="/docs/project/" class="nav-link">
  项目
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>进阶功能</span> <!----></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="进阶功能"><a href="#进阶功能" class="header-anchor">#</a> 进阶功能</h3> <h4 id="_1、数据请求和json-server"><a href="#_1、数据请求和json-server" class="header-anchor">#</a> 1、数据请求和json-server</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// json-server 模拟数据的     npm install json-server -g  等同于yarn json-server -g</span>
<span class="token comment">//axios 数据请求 两个都需要下载 npm install axios --save</span>

<span class="token comment">//1、根目录创建mock文件夹，里面建立data.json模拟数据</span>
<span class="token comment">//2、启动json-server,cd到mock文件夹下   -&gt; json-server {json数据的名字  --port 端口号} 接下来可以在项目对应端口请求到数据</span>
<span class="token comment">//3、引入axios，</span>

<span class="token comment">//在package.json里配置script可以快速启动</span>
<span class="token comment">//之后npm run mock就可以启动+</span>

<span class="token comment">//修改请求地址</span>
<span class="token comment">//json-server ./src/mock/mock.js -r ./src/mock/mockRouter.json -p 9000 -watch</span>
<span class="token comment">//可通过挂在改变请求路径</span>
<span class="token comment">//./src/mock/mockRouter.json里{'/api/hotcate':'/hotcate'}</span>

### 问题：这种方式改变的地址和代理中的reWrite有什么区别？
<span class="token operator">/</span>api<span class="token operator">/</span>hotcate是为了匹配代理，<span class="token operator">-</span>r <span class="token punctuation">.</span><span class="token operator">/</span>src<span class="token operator">/</span>mock<span class="token operator">/</span>mockRouter<span class="token punctuation">.</span>json 里是为了重新指向真实的接口
</code></pre></div><h4 id="_2、跨域处理"><a href="#_2、跨域处理" class="header-anchor">#</a> 2、跨域处理</h4> <div class="language-js extra-class"><pre class="language-js"><code>#### 正向代理   <span class="token operator">--</span>通常用于开发环境 一个位于客户端和目标服务器之间的代理服务器，为了获得目标服务器的内容，客户端向代理服务器发送一个请求，代理服务器帮助我们去目标服务器里面获取数据并且返回给我们

#### 反向代理   <span class="token operator">--</span>可以通过代理服务器来接受网络上的请求连接，然后将这个请求连接转发给内部的网络服务器上，并且把请求到的数据返回给网络请求的客户端，这个时候代理服务器对外的表现就是一个反向代理

<span class="token comment">//模拟请求真实的网络接口 中国天气网的数据</span>
<span class="token comment">//react-scripts-&gt;config-&gt;webpackDevServer-&gt;proxy:{</span>
    <span class="token string">'/api'</span><span class="token operator">:</span><span class="token punctuation">{</span>
        target<span class="token operator">:</span>url<span class="token punctuation">,</span>
        changeOrigin<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token string">&quot;pathRewrite&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token string">&quot;^/api&quot;</span><span class="token operator">:</span><span class="token string">&quot;/&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre></div><h4 id="_3、hoc高阶组件"><a href="#_3、hoc高阶组件" class="header-anchor">#</a> 3、HOC高阶组件</h4> <p>理解：组件加工厂，传入一个组件，通过属性传参和其他操作来为传入的组件添加属性和方法，可以批量实现功能的添加</p> <div class="language-js extra-class"><pre class="language-js"><code>案例见杰哥的大纲
</code></pre></div><h4 id="_4、portal"><a href="#_4、portal" class="header-anchor">#</a> 4、portal</h4> <p>Portals 提供了一个最好的在父组件包含的DOM结构层级外的DOM节点渲染组件的方法。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//解构出createPortal</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createPortal <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>

<span class="token comment">//利用 createPortal语法，将组件挪到相关节点</span>
<span class="token keyword">const</span> <span class="token function-variable function">withPortal</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">Comp</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> Component <span class="token punctuation">{</span>
    <span class="token function">render</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">createPortal</span><span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>Comp <span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
        document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_5、react-redux"><a href="#_5、react-redux" class="header-anchor">#</a> 5、react-redux</h4> <p>个人理解：redux相当于一个可编程的自动化工厂，用于接收defaultState和reducer生成定制化的仓库，配合工厂赠送的高阶组件服务，供需要的地方调用对本身组件进行强化，在Props里增加相应的状态和方法</p> <p>PS:react-redux插件用来解决组件使用redux状态不能自动渲染、页面同步更新的问题</p> <div class="language-js extra-class"><pre class="language-js"><code>### 使用方法
<span class="token comment">//1、根组件解构引入Provider</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Provider<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span>Provider store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span> Provider<span class="token operator">&gt;</span>

<span class="token comment">//2、关于store</span>
<span class="token comment">//store是createStore()的返回对象,createStore()需要掌握的有两个参数，第一个参数是reducer,第二个是applyMiddleware(中间件)的返回对象</span>

<span class="token comment">//3、reducer里的内容是redux功能的基础，下面给一个范例</span>
<span class="token keyword">const</span> defaultState <span class="token operator">=</span> <span class="token punctuation">{</span>
    list<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'task1'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token parameter">state <span class="token operator">=</span> defaultState<span class="token punctuation">,</span>action</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  action <span class="token operator">=</span> action <span class="token operator">||</span><span class="token punctuation">{</span>type<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">}</span>
  <span class="token keyword">switch</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'PUSH_DATA'</span><span class="token operator">:</span>
        <span class="token keyword">return</span><span class="token punctuation">{</span>
        <span class="token operator">...</span>state<span class="token punctuation">,</span>
        list<span class="token operator">:</span><span class="token punctuation">[</span>
            <span class="token operator">...</span>state<span class="token punctuation">.</span>list<span class="token punctuation">,</span>
            action<span class="token punctuation">.</span>task<span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">case</span> <span class="token string">'REMOVE_DATA'</span><span class="token operator">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token operator">...</span>state<span class="token punctuation">,</span>
            list<span class="token operator">:</span>state<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item<span class="token punctuation">,</span>index</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
                <span class="token keyword">return</span> index<span class="token operator">!==</span>action<span class="token punctuation">.</span>index
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token keyword">return</span> state<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//4、actionCreator里异步请求的函数，格式不固定，看个人水平</span>

<span class="token comment">//5、在需要使用的地方引入react-redux的connect</span>
<span class="token comment">//connect(f1,f2)执行出来的结果是一个高阶组件，有两个回调函数作为connect()的参数，第一个函数名为mapStateToProps,第二个函数名为mapDispathToProps</span>
<span class="token comment">//映射store里的state或dispatch到当前组件的props</span>
<span class="token keyword">const</span> <span class="token function-variable function">mapStateToProps</span> <span class="token operator">=</span> <span class="token parameter">state</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        list<span class="token operator">:</span>state<span class="token punctuation">.</span>list
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//映射store里面的dispatch到当前组件的props</span>
<span class="token keyword">const</span> <span class="token function-variable function">mapDispathToProps</span> <span class="token operator">=</span><span class="token parameter">dispatch</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
        <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
           <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
               type<span class="token operator">:</span><span class="token string">'PUSH_DATA'</span>
           <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
        <span class="token punctuation">}</span>
   
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">connect</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span>mapDispathToProps<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><p>纯函数：1）如果相同的入参，那么一定是相同的返回值</p> <p>​               2）不能改变入参</p> <h4 id="_6、redux中间件做异步请求-redux-thunk"><a href="#_6、redux中间件做异步请求-redux-thunk" class="header-anchor">#</a> 6、redux中间件做异步请求-redux-thunk</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1、中间件装在store的Index.js里，实际为createStore所在文件里</span>
<span class="token comment">//2、从redux里解构出applyMiddleware</span>
<span class="token comment">//3、redux-thunk作为参数传给applyMiddleware,将返回的对象作为createStore的第二个参数暴露</span>

### 重点：actionCreator里通过中间件使dispatch得到的返回函数自动执行，返回函数就是做的异步请求
</code></pre></div><h4 id="_7、react-router"><a href="#_7、react-router" class="header-anchor">#</a> 7、React Router</h4> <ul><li><p>包含了四个包：react-router | react-router-dom |react-router-native | react-router-config,主要使用react-router-dom ,<a href="https://reacttraining.com/react-router/web/guides/quick-start" target="_blank" rel="noopener noreferrer">官网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>react是包容性路由（可使用exact精准匹配，使用Switch分支匹配使其具有排他性），vue是排他性路由</p></li> <li><p>路由模式：</p> <p>1）hash  HashRouter (hash模式 带#号  刷新的时候页面不会丢失)</p> <p>2）browser BrowserRouter (历史记录模式 没有#号 他是通过历史记录api来进行路由切换的，刷新会丢失，本地模式不会)</p> <div class="language-js extra-class"><pre class="language-js"><code>### 使用方法
<span class="token comment">// 1、下载 npm install --save react-router-dom</span>
<span class="token comment">// 2、index.js引用路由模块</span>
<span class="token comment">// 3、路由模式包裹根组件</span>
<span class="token comment">// 4、引用 import {Route} from 'react-router-dom'</span>
<span class="token comment">// 5、配置 Route</span>

<span class="token comment">//路由导航    Link to=&quot;去哪里&quot;</span>
<span class="token comment">//           NavLink可以动态设置active的类名</span>

<span class="token comment">// 重定向   Redirect  from=&quot;&quot;  to=&quot;&quot;</span>
           <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>可以实现路由跳转

### 示例用法
<span class="token comment">//1、动态路由</span>
<span class="token comment">// &lt;Route path:'/:id'&gt; 和vue类似，parameters可同通过this.props.match.params</span>

<span class="token comment">//2、nesting路由嵌套</span>
<span class="token comment">// 在子组件里继续写路由</span>

<span class="token comment">//3、query方式传参</span>
<span class="token comment">//1、不需要在路由规则中进行传递参数的配置</span>
<span class="token comment">//2、直接发送数据</span>
<span class="token comment">//3、使用this.props.location.query.xxx</span>
示例：<span class="token operator">&lt;</span>Link to<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>pathname<span class="token operator">:</span><span class="token string">'/'</span><span class="token punctuation">,</span>query<span class="token operator">:</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">'xiaoming'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>Link<span class="token operator">&gt;</span>



### Route组件加载方法
<span class="token number">1</span>、<span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">'/'</span> component<span class="token operator">=</span><span class="token punctuation">{</span>Home<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">&gt;</span>
<span class="token number">2</span>、<span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">'/'</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>Home<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Home<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">&gt;</span>
<span class="token number">3</span>、<span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">'/'</span> render<span class="token operator">=</span><span class="token punctuation">{</span>Home<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">&gt;</span>
<span class="token number">4</span>、<span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">'/'</span> children<span class="token operator">=</span><span class="token punctuation">{</span>Home<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">&gt;</span>

####异同
<span class="token number">1</span><span class="token punctuation">)</span> render属性不能渲染类组件<span class="token punctuation">,</span>强行使用类组件可以采用下面的方式：<span class="token operator">&lt;</span>Route path<span class="token operator">=</span><span class="token string">'/'</span> render<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token operator">&lt;</span>Home <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Home<span class="token operator">&gt;</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">&gt;</span>
    <span class="token comment">//这里的props实际为Route组件的props，是带有路由信息的</span>
    
<span class="token number">2</span><span class="token punctuation">)</span>children无论路径有没有被匹配都会被渲染，也不能用类组件，
可通过<span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>match判断其是否被路由匹配

<span class="token number">3</span>）嵌套方式取不到路由信息

##withRouter是从creact<span class="token operator">-</span>router<span class="token operator">-</span>dom里解构出来的高阶组件，可以监控<span class="token operator">&lt;</span>Route<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">&gt;</span>之外的组件路由信息，<span class="token operator">&lt;</span>Route<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Route<span class="token operator">&gt;</span>、children之外的组件<span class="token keyword">this</span><span class="token punctuation">.</span>props里是没有路由信息的

</code></pre></div></li></ul> <h4 id="_8、hook-16-7新增"><a href="#_8、hook-16-7新增" class="header-anchor">#</a> 8、hook(16.7新增)</h4> <ul><li><p>主要是让函数组件拥有类组件的功能</p></li> <li><p>使用react Hook中的useState来进行实现</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>useState<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token comment">//useState是定义一个状态的，它与类组件的状态不同，函数组件的状态可以实对象也可以是基础数据类型</span>
<span class="token comment">//useState返回的是一个数组，第一个是当前的状态值，第二个是对象，表明用于更改状态的函数(类似于setState)</span>
<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span><span class="token punctuation">{</span>val<span class="token punctuation">,</span>setVal<span class="token punctuation">}</span><span class="token operator">=</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      使用数据：<span class="token punctuation">{</span>val<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token function">setVal</span><span class="token punctuation">(</span>val<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>点我加一<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>


#### 如果有多种方式怎么办？
<span class="token comment">//1、声明对象类型的状态</span>
<span class="token comment">//2、多次声明</span>
<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token comment">//声明对象类型的状态</span>
    <span class="token keyword">let</span><span class="token punctuation">{</span>val<span class="token punctuation">,</span>setVal<span class="token punctuation">}</span><span class="token operator">=</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        vala<span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        valb<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      使用数据：<span class="token punctuation">{</span>val<span class="token punctuation">.</span>vala<span class="token punctuation">}</span><span class="token operator">--</span><span class="token operator">-</span><span class="token punctuation">{</span>val<span class="token punctuation">.</span>valb<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token function">setVal</span><span class="token punctuation">(</span>val<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>点我加一<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
<span class="token comment">//如果有多个状态使用其他方法修改</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>useEffect  处理副作用(重复的功能开发者要在多个生命周期中重复编写)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1、从react引入useEffect</span>
<span class="token comment">//useEffect类似于componentDidMount和componentDidUpdata</span>
<span class="token comment">//2、useEffect 第一个参数接收一个函数，可以用来做一些副作用比如异步请求，修改外部参数等行为，而第二个参数称之为dependencies，是一个数组，如果数组中的值变化才会触发 执行useEffect 第一个参数中的函数。返回值(如果有)则在组件销毁或者调用函数前调用</span>
<span class="token comment">//1）.比如第一个 useEffect 中，理解起来就是一旦 count 值发生改变，则修改 documen.title 值；</span>
<span class="token comment">//2）而第二个 useEffect 中传递了一个空数组[]，这种情况下只有在组件初始化或销毁的时候才会触发，用来代替 componentDidMount 和 componentWillUnmount，慎用；</span>
<span class="token comment">//3） 还有另外一个情况，就是不传递第二个参数，也就是useEffect只接收了第一个函数参数，代表不监听任何参数变化。每次渲染DOM之后，都会执行useEffect中的函数。</span>
<span class="token comment">//useEffect(()=&gt;{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'unmount'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//这样的写法只有销毁时才会执行</span>

#### 做异步请求需要使用自执行函数隔离作用域，否则会和componentUpMount的<span class="token keyword">return</span>冲突

</code></pre></div></li> <li><h5 id="usecontent-减少组件层级-利用usecontent可以是provider和consumer一一对应"><a href="#usecontent-减少组件层级-利用usecontent可以是provider和consumer一一对应" class="header-anchor">#</a> useContent 减少组件层级(利用useContent可以是provider和consumer一一对应)</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span><span class="token punctuation">{</span>Component<span class="token punctuation">,</span>createContent<span class="token punctuation">,</span>useContent<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">const</span> ExcempleContext <span class="token operator">=</span><span class="token function">createContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//用ExcempleCOntext.Provider包裹上层组件</span>
<span class="token keyword">const</span> excemple<span class="token operator">=</span><span class="token function">useContent</span><span class="token punctuation">(</span>ExcempleContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token comment">//上面的方式等于</span>
 <span class="token operator">&lt;</span>Consumer<span class="token operator">&gt;</span>
    <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span>value<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">}</span>     
 <span class="token operator">&lt;</span><span class="token operator">/</span>Consumer<span class="token operator">&gt;</span>
</code></pre></div></li> <li><h5 id="usereducer-这个-hooks-在使用上几乎跟-redux-react-redux-一模一样-唯一缺少的就是无法使用-redux-提供的中间件。"><a href="#usereducer-这个-hooks-在使用上几乎跟-redux-react-redux-一模一样-唯一缺少的就是无法使用-redux-提供的中间件。" class="header-anchor">#</a> useReducer  这个 Hooks 在使用上几乎跟 Redux/React-Redux 一模一样，唯一缺少的就是无法使用 redux 提供的中间件。</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span><span class="token punctuation">{</span>useReducer<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token comment">//组件内 使用下列语句</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span>dispath<span class="token punctuation">]</span><span class="token operator">=</span><span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span>defaultData<span class="token punctuation">)</span><span class="token punctuation">;</span>
此方法不需要从react里解构Provider
</code></pre></div></li> <li><h5 id="usecallback-记忆函数-可以优化性能-组件重新渲染会刷新引用"><a href="#usecallback-记忆函数-可以优化性能-组件重新渲染会刷新引用" class="header-anchor">#</a> useCallback 记忆函数   可以优化性能(组件重新渲染会刷新引用)</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span><span class="token punctuation">{</span>useReducer，useCallback<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> memoizedHandleClick <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Click happened'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 空数组代表无论什么情况下该函数都不会发生改变</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>SomeComponent onClick<span class="token operator">=</span><span class="token punctuation">{</span>memoizedHandleClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>Click Me<span class="token operator">&lt;</span><span class="token operator">/</span>SomeComponent<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

### 要配合pureComponent使用，也可以从react中结构出memo<span class="token punctuation">,</span>这是一个<span class="token constant">HOC</span><span class="token punctuation">,</span>也能保证数据不改变就不渲染
</code></pre></div></li> <li><h5 id="usememo记忆组件-更强大"><a href="#usememo记忆组件-更强大" class="header-anchor">#</a> useMemo记忆组件  更强大</h5> <p>useCallback(fn, inputs) is equivalent to useMemo(() =&gt; fn, inputs).</p> <p>区别：useCallback 不会执行第一个参数函数，而是将它返回给你，而 useMemo 会执行第一个函数并且将函数执行结果返回给你</p> <p>所以 useCallback 常用记忆事件函数，生成记忆后的事件函数并传递给子组件使用。而 useMemo 更适合经过函数计算得到一个确定的值，比如记忆组件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Parent</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> a<span class="token punctuation">,</span> b <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// Only re-rendered if `a` changes:</span>
  <span class="token keyword">const</span> child1 <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>Child1 a<span class="token operator">=</span><span class="token punctuation">{</span>a<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Only re-rendered if `b` changes:</span>
  <span class="token keyword">const</span> child2 <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>Child2 b<span class="token operator">=</span><span class="token punctuation">{</span>b<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>b<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>child1<span class="token punctuation">}</span>
      <span class="token punctuation">{</span>child2<span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><h5 id="prop更改时重新计算某些数据-使用memoization-helper"><a href="#prop更改时重新计算某些数据-使用memoization-helper" class="header-anchor">#</a> prop更改时重新计算某些数据，使用memoization helper</h5> <h5 id="官方文档"><a href="#官方文档" class="header-anchor">#</a> <a href="https://zh-hans.reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html#what-about-memoization" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> memoize <span class="token keyword">from</span> <span class="token string">'memoize-one'</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h4 id="_9、react项目目录"><a href="#_9、react项目目录" class="header-anchor">#</a> 9、React项目目录</h4> <ul><li><p>src</p> <ul><li><p>页面/模块文件夹</p> <ul><li>container 文件夹    放置容器组件(数据获取、状态更新)</li> <li>ui文件夹     放置展示组件(描述如何展现(骨架、样式))</li> <li>actionCreator.js(放置异步请求)</li> <li>actionTypes.js(放置dispatch的type，通过路径命名避免重复)</li> <li>reducer.js(页面/模块独享reducer，定制化方法和数据)</li> <li>index.js 对外的接口 ，用于暴露reducer和整个模块/页面</li></ul></li> <li><p>store 文件夹</p> <ul><li><p>reducer.js   通过redux中结构出的combineReducers整合所有模块的reducer,使用方法如下</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> reducer <span class="token operator">=</span><span class="token function">combineReducers</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    cooksReducer<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>index.js 对外的接口，暴露出的reducer可作为createStore的第一个参数</p></li></ul></li></ul></li> <li><table><thead><tr><th style="text-align:right;"></th> <th style="text-align:left;">展示组件</th> <th style="text-align:left;">容器组件</th></tr></thead> <tbody><tr><td style="text-align:right;">作用</td> <td style="text-align:left;">描述如何展现（骨架、样式）</td> <td style="text-align:left;">描述如何运行（数据获取、状态更新）</td></tr> <tr><td style="text-align:right;">直接使用 Redux</td> <td style="text-align:left;">否</td> <td style="text-align:left;">是</td></tr> <tr><td style="text-align:right;">数据来源</td> <td style="text-align:left;">props</td> <td style="text-align:left;">监听 Redux state</td></tr> <tr><td style="text-align:right;">数据修改</td> <td style="text-align:left;">从 props 调用回调函数</td> <td style="text-align:left;">向 Redux 派发 actions</td></tr> <tr><td style="text-align:right;">调用方式</td> <td style="text-align:left;">手动</td> <td style="text-align:left;">通常由 React Redux 生成</td></tr></tbody></table></li> <li><p>这种方式取得的数据是按照未合并的reducer名进行划分的(在组件内使用时即connect方法自动添加，获取数据时是没有的)，使用时需要注意，同时也是保证不同开发者数据不冲突的方法.</p></li></ul> <h4 id="_10、给路由切换添加动画"><a href="#_10、给路由切换添加动画" class="header-anchor">#</a> 10、给路由切换添加动画</h4> <p><a href="https://www.zhangshengrong.com/p/281omYrgNw/" target="_blank" rel="noopener noreferrer">封装<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://zhuanlan.zhihu.com/p/260748979" target="_blank" rel="noopener noreferrer">模式<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>使用过程中，页面切换需要前一个页面先离开后一个页面才能进入，这是要使用模式里的方案</p> <p>PS:实际应用中，一般主页面不动，跳转的页面划入。这个时候就需要 用route的children加载，而children加载类组件又需要以&lt;Route children={(Props)=&gt;&lt;组件名 {...Props} /&gt;}&gt;</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.2c569677.js" defer></script><script src="/docs/assets/js/2.b553e760.js" defer></script><script src="/docs/assets/js/9.1f4f5613.js" defer></script>
  </body>
</html>
